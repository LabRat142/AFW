<!DOCTYPE html>
<html>
<head>
    <title>Watchlist</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="./css/index.css" rel="stylesheet" />
	<script src="./js/index.js" type="text/javascript"></script>
	<script src="./js/search.js" type="text/javascript"></script>
	<script src="./js/relations.js" type="text/javascript"></script>
	<script src="./js/list.js" type="text/javascript"></script>
	<script src="./js/details.js" type="text/javascript"></script>
	<script src="./js/recalc.js" type="text/javascript"></script>
</head>
<body>
	<!-- Home Page -->
	<div id="index" class="section" style="display:block;">
		<div class="container py-5">
			<!-- Title & Info -->
			<div class="text-center mb-4">
				<h1 class="fw-bold text-primary">🎬 Anime Watchlist</h1>
				<p class="text-muted">Track your favorites, explore franchises, and build your perfect list.</p>
			</div>

			<div class="row justify-content-center">
				<!-- GOTO Anime Search -->
				<div class="col-md-4 mb-3">
					<div class="card shadow-sm h-100">
						<div class="card-body text-center">
							<h5 class="card-title">🔍 Search Anime</h5>
							<p class="card-text">Find titles, explore related series, and add them to your franchise.</p>
							<button class="btn btn-primary mt-2" onclick="navigate('search')">Start Searching</button>
						</div>
					</div>
				</div>
				<!-- GOTO My List -->
				<div class="col-md-4 mb-3">
					<div class="card shadow-sm h-100">
						<div class="card-body text-center">
							<h5 class="card-title">📋 View My List</h5>
							<p class="card-text">See your saved franchises, update them, or remove entries.</p>
							<button class="btn btn-secondary mt-2" onclick="navigate('list')">Go to List</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<!-- Anime Search Page -->
	<div id="search" class="section" style="display:none;">
		<div class="container py-4">
			<!-- Navigation Buttons -->
			<div class="top-0 end-0 my-2 d-flex justify-content-end">
				<button class="btn btn-outline-secondary" onclick="navigate('list');">
					📋 Go to List
				</button>
			</div>
			<!-- Search Input -->
			<div class="mb-4 input-group">
				<input type="text" id="animeSearchInput" class="form-control" placeholder="Search anime..." />
				<button class="btn btn-primary" onclick="fetchItems()">Search</button>
			</div>
			<!-- Search Results -->
			<div class="row" id="SearchCardContainer"></div>
		</div>
	</div>
	
	<!-- Relations Finder Page -->
	<div id="relations" class="section" style="display:none;">
		<div class="container py-4 position-relative">
			<!-- Navigation Buttons -->
			<div class="position-absolute top-0 end-0 m-3 d-flex flex-column align-items-end" style="z-index: 10;">
				<button class="btn btn-outline-secondary mb-2" onclick="navigate('search');">
					← Go back to search
				</button>
				<button class="btn btn-outline-secondary" onclick="navigate('list');">
					📋 Go to My List
				</button>
			</div>
			<!-- Info -->
			<div class="d-flex flex-column align-items-center mb-4">
				<img id="loading-img" src="./images/loading.gif" class="mb-3" style="width:160px; height:160px;" alt="Loading..." />
				<h4 id="info-title" class="text-primary fw-semibold mb-2">Loading your franchise...</h4>
				<p class="text-muted text-center mb-3" style="max-width: 400px;">
					Once loading is complete, click on one of the anime cards below to select a cover image. Then press the button to save your franchise.
				</p>
				<button id="addAnimeBtn" class="btn btn-lg btn-success px-4" disabled onclick="addFranchise()">♥️ Save Franchise</button>
			</div>
			<!-- Results -->
			<div class="row" id="RelationsCardContainer"></div>
		</div>
	</div>
	
	<!-- My List Page -->
	<div id="list" class="section" style="display:none;">
		<div class="container py-4">
			<!-- Navigation Buttons -->
			<div class="d-flex justify-content-between align-items-center mb-3">
				<div class="d-flex gap-2">
					<button class="btn btn-outline-success" onclick="exportFranchises()">⬇️ Export JSON</button>
					<label class="btn btn-outline-warning mb-0">
						⬆️ Import JSON
						<input type="file" accept=".json" onchange="importFranchises(event)" hidden />
					</label>
				</div>
				<button class="btn btn-outline-secondary" onclick="navigate('search');">🔍 Go to Search</button>
			</div>
			<!-- Ttile & ViewToggle -->
			<div class="d-flex align-items-center gap-2 mb-4">
				<h2 id="toggleViewBtn" class="text-primary fw-bold mb-0" onclick="toggleViewMode()">🖼</h2>
				<h2 class="text-primary fw-bold mb-0">My Franchises</h2>
			</div>
			<!-- Search Input -->
			<input type="text" class="form-control mb-3" id="franchisesSearchInput" placeholder="🔍 Search franchises..." oninput="filterFranchises()" />
			<!-- List -->
			<div id="FranchisesCardContainer"></div>
			<div id="FranchisesListContainer" style="display:none;"></div>
			<!-- GOTO Update Franchises -->
			<div class="d-flex flex-row justify-content-end my-2">
				<button class="btn btn-outline-success" onclick="navigate('recalc')">Update Franchises</button>
			</div>
		</div>
		
	</div>
	
	<!-- Franchise Details Page -->
	<div id="details" class="section" style="display:none;">
		<div class="container py-4">
			<!-- Navigation Button -->
			<button class="btn btn-outline-secondary mb-3" onclick="navigate('list')">← Back to List</button>
			
			<div class="row">
				<!-- Left: Franchise Info -->
				<div class="col-md-4 text-center">
					<img id="checkmark-image" class="img-fluid m-1" src="./images/unchecked.png" style="position:absolute; height:50px; width:50px;" onclick="markCompleted()">
					<img id="details-image" class="img-fluid rounded shadow mb-3" style="max-height: 300px;" alt="Franchise Cover" />
					<h3 id="details-name" class="text-primary fw-bold"></h3>
					<p id="details-completion" class="text-muted text-center mb-3">Not Completed</p>
					<div class="d-flex justify-content-center gap-2 mt-2">
						<button class="btn btn-sm btn-outline-primary" onclick="editFranchiseName()">✏️ Edit Name</button>
						<button class="btn btn-sm btn-outline-danger" onclick="deleteFranchise()">🗑️ Delete Franchise</button>
					</div>
					<p id="total-episodes" class="text-muted text-center mb-3"></p>
				</div>
				<!-- Right: Anime List -->
				<div class="col-md-8">
					<h5 class="mb-3">📺 Anime in this Franchise</h5>
					<ul id="details-anime-list" class="list-group"></ul>
				</div>
			</div>
		</div>
	</div>
	
	<!-- Update Franchises Page -->
	<div id="recalc" class="section" style="display:none;">
		<div class="container py-4 position-relative">
			<!-- Navigation Buttons -->
			<div class="position-absolute top-0 end-0 m-3 d-flex flex-column align-items-end" style="z-index: 10;">
				<button class="btn btn-outline-secondary" onclick="navigate('list');">
					📋 Go to My List
				</button>
			</div>
			<!-- Info -->
			<div class="d-flex flex-column align-items-center mb-4">
				<img id="recalc-loading-img" src="./images/loading.gif" class="mb-3" style="width:160px; height:160px;" alt="Loading..." />
				<h4 id="recalc-info-title" class="text-primary fw-semibold mb-2">Loading ...</h4>
				<p class="text-muted text-center mb-3" style="max-width: 400px;">
					As anime titles load, missing entries will appear below. Clicking the button will update your existing franchises with the latest details and add any new titles.
				</p>
				<button id="recalc-addAnimeBtn" class="btn btn-lg btn-success px-4" disabled onclick="updateFranchises()">♥️ Update Franchises</button>
			</div>
			<!-- Results -->
			<div class="row" id="RecalcCardContainer"></div>
		</div>
	</div>
</body>
</html>
